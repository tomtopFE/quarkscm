(function(d){function h(v){var n=d(this),g=null,m=[],p=null,e=null,c=d.extend({rowSelector:"\x3e li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:d.noop,exit:d.noop,activate:d.noop,deactivate:d.noop,exitMenu:d.noop},v),t=function(b){b!=g&&(g&&c.deactivate(g),c.activate(b),g=b)},u=function(b){var a=h();a?e=setTimeout(function(){u(b)},a):t(b)},h=function(){function b(a,b){return(b.y-a.y)/(b.x-a.x)}if(!g||!d(g).is(c.submenuSelector))return 0;var a=n.offset(),e={x:a.left,y:a.top-c.tolerance},q={x:a.left+n.outerWidth(),y:e.y},h={x:a.left,y:a.top+n.outerHeight()+c.tolerance},r={x:a.left+n.outerWidth(),y:h.y},k=m[m.length-1],f=m[0];if(!k)return 0;f||(f=k);if(f.x<a.left||f.x>r.x||f.y<a.top||f.y>r.y||p&&k.x==p.x&&k.y==p.y)return 0;var l=q,a=r;"left"==c.submenuDirection?(l=h,a=e):"below"==c.submenuDirection?(l=r,a=h):"above"==c.submenuDirection&&(l=e,a=q);e=b(k,l);q=b(k,a);l=b(f,l);f=b(f,a);if(e<l&&q>f)return p=k,300;p=null;return 0};n.mouseleave(function(){e&&clearTimeout(e);c.exitMenu(this)&&(g&&c.deactivate(g),g=null)}).find(c.rowSelector).mouseenter(function(){e&&clearTimeout(e);c.enter(this);u(this)}).mouseleave(function(){c.exit(this)}).click(function(){t(this)});d(document).mousemove(function(b){m.push({x:b.pageX,y:b.pageY});3<m.length&&m.shift()})}d.fn.menuAim=function(d){this.each(function(){h.call(this,d)});return this}})(jQuery);